<?xml version="1.0" encoding="utf-8" ?>
<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="onNavigatingTo" class="page">
    <ActionBar title="Register" class="action-bar">
        <NavigationButton visibility="collapsed" />
    </ActionBar>
    
    <GridLayout>
        <!-- Offline Banner -->
        <Label text="You are offline. Registration will be available when connection is restored." 
               class="offline-banner p-2 text-center" 
               visibility="{{ isOffline ? 'visible' : 'collapsed' }}"
               horizontalAlignment="center"
               verticalAlignment="top"/>
               
        <ScrollView>
            <StackLayout class="p-4" verticalAlignment="center">
                <Label text="Create your account" class="h1 text-center" marginBottom="20" />
                
                <!-- Username Field -->
                <Label text="Username" class="label" />
                <TextField 
                    hint="Choose a username" 
                    text="{{ username }}" 
                    autocorrect="false"
                    autocapitalizationType="none"
                    returnKeyType="next"
                    class="input" 
                    marginBottom="10"
                    isEnabled="{{ !isLoading }}" />
                <Label text="{{ usernameError }}" class="error-label" visibility="{{ usernameError ? 'visible' : 'collapsed' }}" />
                
                <!-- Email Field -->
                <Label text="Email" class="label" />
                <TextField 
                    hint="Enter your email" 
                    text="{{ email }}" 
                    keyboardType="email"
                    autocorrect="false"
                    autocapitalizationType="none"
                    returnKeyType="next"
                    class="input" 
                    marginBottom="10"
                    isEnabled="{{ !isLoading }}" />
                <Label text="{{ emailError }}" class="error-label" visibility="{{ emailError ? 'visible' : 'collapsed' }}" />
                
                <!-- Password Field -->
                <Label text="Password" class="label" />
                <TextField 
                    hint="Create a password" 
                    text="{{ password }}" 
                    secure="true"
                    returnKeyType="next"
                    class="input"
                    marginBottom="10"
                    isEnabled="{{ !isLoading }}" />
                <Label text="{{ passwordError }}" class="error-label" visibility="{{ passwordError ? 'visible' : 'collapsed' }}" />
                
                <!-- Game ID Field -->
                <Label text="Game ID (optional)" class="label" />
                <TextField 
                    hint="Enter your game ID" 
                    text="{{ gameId }}" 
                    returnKeyType="done"
                    class="input"
                    marginBottom="10"
                    isEnabled="{{ !isLoading }}" />
                <Label text="{{ gameIdError }}" class="error-label" visibility="{{ gameIdError ? 'visible' : 'collapsed' }}" />
                
                <!-- Register Button -->
                <Button 
                    text="{{ isLoading ? 'Creating account...' : 'Register' }}" 
                    tap="{{ onRegister }}" 
                    class="btn btn-primary" 
                    marginTop="10"
                    isEnabled="{{ !isLoading && !isOffline && canRegister }}" />
                
                <!-- Back to Login -->
                <Button 
                    text="Back to Login" 
                    tap="{{ onBackToLogin }}" 
                    class="btn btn-secondary"
                    marginTop="10"
                    isEnabled="{{ !isLoading }}" />
                
                <!-- Loading Indicator -->
                <ActivityIndicator busy="{{ isLoading }}" marginTop="20" />
                
                <!-- Error Message -->
                <Label 
                    text="{{ errorMessage }}" 
                    class="error-message text-center" 
                    textWrap="true"
                    visibility="{{ errorMessage ? 'visible' : 'collapsed' }}"
                    marginTop="10" />
            </StackLayout>
        </ScrollView>
    </GridLayout>
</Page>