<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="onNavigatingTo">
    <ActionBar title="Tournaments">
        <ActionItem ios.position="right" android.position="actionBar">
            <StackLayout orientation="horizontal">
                <Button text="Open" tap="{{ filterByStatus }}" class="{{ _currentFilter === 'open' ? 'active-filter' : '' }}" />
                <Button text="In Progress" tap="{{ filterByStatus }}" class="{{ _currentFilter === 'in_progress' ? 'active-filter' : '' }}" />
                <Button text="Completed" tap="{{ filterByStatus }}" class="{{ _currentFilter === 'completed' ? 'active-filter' : '' }}" />
            </StackLayout>
        </ActionItem>
    </ActionBar>

    <GridLayout rows="auto, *">
        <!-- Loading Indicator -->
        <ActivityIndicator row="0" busy="{{ isLoading }}" visibility="{{ isLoading ? 'visible' : 'collapsed' }}" />

        <!-- Tournament List -->
        <PullToRefresh row="1" refresh="{{ onPullToRefresh }}">
            <ListView items="{{ tournaments }}" itemTap="{{ onTournamentTap }}" class="tournament-list">
                <ListView.itemTemplate>
                    <GridLayout columns="*, auto" rows="auto, auto, auto" class="tournament-item p-10 m-5">
                        <!-- Tournament Header -->
                        <StackLayout col="0" row="0" orientation="horizontal">
                            <Label text="{{ title }}" class="tournament-title font-weight-bold" />
                            <Label text="{{ status }}" class="status-badge status-{{ status }} m-l-5" />
                        </StackLayout>
                        <Label col="1" row="0" text="{{ 'Prize: ₹' + prize_pool }}" class="prize-pool text-right text-primary" />
                        
                        <!-- Tournament Info -->
                        <GridLayout col="0" colSpan="2" row="1" columns="auto, auto, *" class="tournament-info m-t-5">
                            <Label col="0" text="{{ game_type }}" class="game-type" />
                            <Label col="1" text="{{ '|' }}" class="separator m-x-5" />
                            <Label col="2" text="{{ current_participants + '/' + max_participants + ' Players' }}" class="participants" />
                        </GridLayout>
                        
                        <!-- Tournament Footer -->
                        <GridLayout col="0" colSpan="2" row="2" columns="auto, *" class="tournament-footer m-t-5">
                            <Label col="0" text="{{ 'Entry: ₹' + entry_fee }}" class="entry-fee" />
                            <Label col="1" text="{{ start_time | timeFromNow }}" class="start-time text-right" />
                        </GridLayout>
                    </GridLayout>
                </ListView.itemTemplate>
            </ListView>
        </PullToRefresh>

        <!-- Empty State -->
        <StackLayout row="1" visibility="{{ !isLoading && tournaments.length === 0 ? 'visible' : 'collapsed' }}" 
                     horizontalAlignment="center" verticalAlignment="center">
            <Label text="No tournaments found" class="empty-message" />
            <Label text="Pull to refresh" class="empty-submessage" />
        </StackLayout>
    </GridLayout>
</Page>